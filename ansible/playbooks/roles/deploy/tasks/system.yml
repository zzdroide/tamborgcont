- name: Disable quiet boot
  ansible.builtin.replace:
    path: /etc/default/grub
    regexp: ^GRUB_CMDLINE_LINUX_DEFAULT="quiet (.+)
    replace: GRUB_CMDLINE_LINUX_DEFAULT="\1
  become: true
  register: dqb

- name: Update-grub
  ansible.builtin.command: update-grub
  when: dqb.changed
  become: true

- name: Add silence-console.service
  ansible.builtin.copy:
    src: files/silence-console.service
    dest: /etc/systemd/system/silence-console.service
    owner: root
    group: root
    mode: 0644
  become: true

- name: Enable and start silence-console.service
  ansible.builtin.systemd:
    name: silence-console.service
    state: started
    enabled: true
  become: true
